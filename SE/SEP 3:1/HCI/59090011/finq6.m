clc clearclose all% load DTMF dataload dtmf.mat% define the sampling ratefs = 10000;n = length(key);% time variablet = 0 : 1/fs : n/fs - 1/fs;% plot raw DTMF signal in time domainplot(t,key)% separating the keys in time domaink1 = key(1*fs: 2*fs);k2 = key(3*fs: 4*fs);k3 = key(5*fs: 6*fs);fdomain = 0:fs/2-1;fx1 = fft(k1, fs);afx1 = abs(fx1);afx1 = afx1 -1;fx2 = fft(k2, fs);afx2 = abs(fx2);afx2 = afx2 -1;fx3 = fft(k3, fs);afx3 = abs(fx3);afx3 = afx3 -1;[magnitude fmax1] = max(afx1);[magnitude fmax2] = max(afx2);[magnitude fmax3] = max(afx3);R_threshold1 = max(afx1)/2;val1 = find(afx1>R_threshold1);val1 -= 1R_threshold2 = max(afx1)/2;val2 = find(afx2>R_threshold2);val2 -= 1R_threshold3 = max(afx1)/2;val3 = find(afx3>R_threshold3);val3 -= 1stem(fdomain, afx1(1:floor(end/2)))figurestem(fdomain, afx1(1:floor(end/2)))figurestem(fdomain, afx1(1:floor(end/2)))